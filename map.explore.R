library(shiny)
library(shinydashboard)
library(leaflet)
library(dplyr)
library(ggplot2)
library(DT)

library(choroplethr)
library(choroplethrZip)


# Documentation here, https://arilamstein.com/creating-zip-code-choropleths-choroplethrzip/

# Structure the data I want mapped in the same way this file is structured
### Region = Zip Code
### Values = Numeric value that determines zip codes' colors on the map


# This data has the region codes that I'll need to align to the zip codes from the FEC data
data(zip.regions)
regions = zip.regions
head(regions)

regions = regions %>% 
  filter(state.name == 'florida' | state.name =='iowa' | state.name =='michigan' |
           state.name == 'ohio' | state.name == 'pennsylvania' | state.name == 'wisconsin') %>%
  rename(zip = region) %>% 
  select(zip, state.name)

head(regions)





# Pull in cleaned data
df = read.csv('pete_bernie.csv')

df = df %>%
  select(-X) %>% 
  filter(amount>0) %>% 
  filter(candidate=='Pete Buttigieg')
head(df)

#write.csv(df, 'pete.csv')

df$zip = as.character(df$zip)



#########################
### Cleaning for Maps ###
#########################

# Map plots NA for zip codes that do not exist (meaing no donations)
# Need to add these zip codes with a value of zero for each map to work


### Pete Florida ###
p_zips_fl = data.frame('region'=c(33954, 32145, 34474, 32773, 33843, 34289, 32061, 32603, 32219, 32423, 32024, 32547, 34138, 32227, 33981, 33190, 34461, 
                                  34797, 33597, 32466, 33403, 33944, 33167, 32053, 32062, 33762, 33031, 33470, 33890, 32044, 32438, 33853, 32331, 32336, 
                                  33615, 32410, 32131, 32759, 32427, 34946, 32426, 32683, 33054, 32254, 32052, 32432, 32509, 32068, 33565, 34473, 34981, 
                                  32072, 33948, 33760, 34661, 33839, 32784, 34475, 32059, 32641, 34140, 33872, 32009, 34773, 32206, 33849, 32079, 34608, 
                                  32190, 32033, 33785, 32087, 32431, 32063, 32071, 32073, 32440, 32443, 32129, 32130, 32094, 32445, 32095, 32102, 32460, 
                                  32140, 32147, 32189, 32511, 32193, 32195, 32571, 32134, 33976, 33027, 32535, 32221, 32539, 32542, 32234, 32244, 32324, 
                                  32327, 32352, 32420, 32359, 33542, 33541, 32703, 33549, 32744, 33035, 33585, 32754, 33567, 33570, 32767, 33122, 33619, 
                                  32809, 33430, 32579, 32831, 33162, 32920, 32616, 32617, 33169, 32622, 33170, 33471, 33463, 32656, 32686,
                                  33182, 32693, 33184, 32643, 33778, 32421, 34785, 33856, 34679, 32066, 32736, 33540, 33865, 33852, 34428, 33875, 34433, 
                                  33924, 34470, 34465, 33952, 33953, 33935, 33956, 33974, 34498, 33971, 34614, 34638, 33972, 34606, 33765, 34690, 34139, 
                                  33815, 33809, 33823, 34762, 33825, 33827, 34753, 34744, 33830, 33898, 32908, 32465, 32110, 32330, 32040, 33534, 32648, 
                                  34655, 32970, 33513, 34769, 34956, 32448, 33876, 32350, 32180, 33877, 33566, 32124, 32927, 32433, 32424, 32428, 32653, 
                                  32833, 32631, 32209, 32091, 32442, 32702, 33438, 32187, 32628, 32113, 32141, 32055, 33493, 32447, 32948, 33538, 32692, 
                                  33930, 33965, 32355, 32181, 33993, 33841, 33194, 32356, 32456, 32463, 33036, 34604, 33573, 33128, 34610, 34654, 32449, 
                                  32083, 32220, 34141, 34691, 32157, 32694, 33187, 33867, 32619, 32508, 32658, 32621, 33177, 32228, 34420, 32565, 33873, 
                                  32732, 33023, 32277, 33576, 32820, 32310, 32064, 33850, 32668, 33013, 34668, 32437, 32322, 32025, 34436,
                                  32208, 32922, 32830, 34484, 34602, 32332, 32340, 32323, 34142, 34705, 33016, 33527, 32343, 32351, 32399, 32446, 33034, 
                                  32735, 32764, 33068, 33071, 33404, 32798, 33616, 33620, 33147, 32612, 32949, 32625, 32640, 33174, 32697, 33001, 34445, 
                                  32133, 32435, 33834, 33838, 33847, 33851, 33855, 34286, 34431, 34972, 33967, 33973, 34101, 34137, 34734, 32925, 32046, 
                                  33051, 32348, 33063, 32530, 32544, 32570, 32568, 32681, 32347, 32564, 33521, 33101, 32026, 32464, 34215, 32334, 33055, 
                                  33476, 32455, 32212, 34448, 32096, 32664, 32321, 32730, 33945, 32011, 32054, 32567, 32358, 34268, 32462, 33503, 33854, 
                                  33857, 32139, 32709, 32179, 32403, 33136, 33621, 32639, 33848, 34947, 34974, 34739, 34488, 33039, 33781, 32361, 32531, 
                                  32346, 32112, 32430),
                       'value'=0)
p_zips_fl$region = as.character(p_zips_fl$region)


### Pete Iowa ###
p_zips_ia = data.frame('region'=c(50105, 52066, 50062, 52581, 50116, 50035, 52224, 50843, 52543, 51465, 50146, 51241, 50060, 51561, 50556, 50630, 50025, 
                                  50101, 50067, 50667, 50128, 50468, 50027, 50668, 50039, 52255, 50569, 51575, 50438, 51436, 52154, 52347, 50517, 52401, 
                                  52312, 52032, 52211, 50673, 52548, 50136, 50274, 51648, 51526, 50055, 50252, 50235, 50243, 50244, 50484, 52353, 50277, 
                                  50155, 50071, 51248, 52553, 51431, 50020, 50044, 50207, 50675, 52214, 50056, 51006, 50833, 50514, 52555, 51347, 50163, 
                                  50225, 50148, 50229, 52330, 52342, 50072, 50051, 50548, 52035, 50835, 52208, 50149, 52077, 51357, 50007, 50528, 52638, 
                                  50426, 50236, 50520, 52163, 50455, 52064, 51510, 50642, 52164, 52572, 51533, 50212, 50164, 50167, 51026, 51650, 50106, 
                                  50213, 50636, 50665, 52567, 50117, 51553, 50423, 52593, 50238, 51062, 52151, 50042, 51542, 50670, 50048, 50511, 52318, 
                                  52201, 51030, 51049, 50217, 50103, 51433, 50575, 51008, 50420, 50658, 50165, 51051, 50026, 52646, 52752,
                                  51653, 51230, 51630, 50672, 50139, 52133, 51548, 50845, 51573, 51649, 52766, 50001, 50006, 50133, 50246, 50034, 52309, 
                                  50669, 50585, 52720, 51231, 50122, 52236, 50061, 52655, 52739, 50863, 50153, 51333, 50002, 50464, 50581, 50123, 50076, 
                                  50626, 52571, 52594, 50604, 52325, 51245, 51035, 50421, 52215, 50645, 50648, 50651, 50653, 50654, 51061, 50065, 50075, 
                                  51109, 50676, 50144, 50168, 50115, 50135, 50707, 50228, 50232, 50830, 50223, 51001, 51003, 51005, 51010, 50846, 50851, 
                                  50854, 50857, 50254, 50858, 50258, 50862, 50264, 50839, 51023, 51025, 51012, 51014, 51016, 51018, 51019, 51022, 50448, 
                                  50469, 50471, 50472, 50440, 51341, 51048, 51060, 50433, 51052, 50452, 50132, 50454, 50434, 50435, 50457, 50439, 50446, 
                                  50518, 50522, 50523, 50527, 50529, 50530, 50510, 50533, 50515, 50516, 50539, 50475, 50476, 50541, 50542, 50544, 50546, 
                                  50570, 50558, 50560, 50566, 50567, 50576, 50568, 50582, 50583, 50590, 50594, 50602, 50609, 50619, 50621,
                                  50624, 50625, 50627, 50628, 50632, 52551, 51535, 51536, 51540, 51541, 52576, 52580, 52583, 52586, 52588, 52590, 51528, 
                                  51529, 52554, 51530, 52563, 52565, 52570, 52623, 51543, 51576, 51544, 51545, 52630, 51577, 51550, 51551, 51552, 51555, 
                                  51557, 52640, 51571, 51566, 52660, 52726, 52729, 52730, 51632, 51637, 51640, 52645, 52650, 51646, 52651, 51654, 52653, 
                                  52656, 52756, 52758, 52065, 52069, 52031, 52073, 52074, 52038, 52076, 52079, 52040, 52045, 52048, 52745, 52053, 52054, 
                                  52751, 52754, 52802, 52768, 52772, 52140, 52774, 52142, 52146, 52147, 52218, 52222, 52156, 52223, 52158, 52159, 52160, 
                                  52228, 52169, 52170, 52171, 52172, 52205, 52212, 52217, 52237, 52248, 52253, 51247, 52326, 52329, 52332, 52306, 51249, 
                                  52335, 52310, 52339, 52316, 51240, 52320, 52321, 52322, 52323, 51334, 51346, 52362, 51354, 51365, 51366, 52348, 52355, 
                                  52356, 51351, 52361, 51523, 51445, 51447, 52530, 51527, 51448, 52533, 51454, 52535, 51455, 51462, 51463,
                                  52536, 51466, 52549, 52550, 50681, 51451, 50467, 52351, 50577, 50102, 50432, 50104, 50033, 50147, 50046, 51440, 50052, 
                                  50050, 50008, 52301, 52050, 51638, 50837, 52769, 52203, 51450, 50647, 50234, 50130, 50134, 50151, 50249, 52746, 51038, 
                                  51237, 52257, 52135, 52584, 50836, 52620, 50230, 52619, 50860, 50450, 52639, 52049, 51342, 50150, 50120, 52635, 50483, 
                                  51558, 50611, 50635, 50256, 50519, 51053, 50849, 50655, 52748, 50058, 51570, 52221, 50275, 50064, 50562, 52327, 51546, 
                                  52072, 50652, 52573, 50551, 51056, 50680, 52132, 51103, 52166, 51446, 51458, 50644, 50682, 50166, 50853, 51563, 50262, 
                                  50477, 50219, 50140, 56027, 50664, 51004, 50859, 51443, 51111, 51250, 52727, 52649, 52552, 51033, 51345, 50607, 52659, 
                                  52540, 52305, 52254, 50327, 52162, 50479, 50638, 51232, 52354, 50129, 50605, 51442, 51556, 50074, 51239, 52334, 52561, 
                                  51532, 51572, 50173, 50524, 52165, 50073, 50218, 52632, 51559, 51564, 52731, 51579, 50231, 52037, 52041,
                                  52044, 52654, 52658, 52721, 50641, 50842, 52046, 52078, 52155, 52175, 52207, 52144, 50674, 50278, 52251, 50606, 50250, 
                                  50257, 52231, 51011, 50160, 50563, 50532, 52560, 51343, 50864, 52345, 51235, 51453, 50436, 50441, 51044, 51047, 51054, 
                                  51430, 51358, 50424, 51027, 51029, 50536, 50540, 50171, 51439, 50554, 50431, 50458, 50449, 51037, 52225, 52324, 52047, 
                                  51046, 50599, 51055, 50579, 50586, 52070, 51560, 51565, 52621, 50451, 50465, 50143, 50022, 52777, 50068, 50268, 50005, 
                                  51636, 51031, 50251, 50222, 51645, 52742, 52141, 52542, 52157, 50482, 50174, 50557, 51201, 50108, 52313, 52352, 50210, 
                                  50038, 52625, 50521, 50538, 51058, 50276, 51034, 51041, 50012, 50453, 50650, 52738, 50161, 50447, 50565, 51028, 50206, 
                                  50460, 50861, 50057, 50622, 50633, 52569, 50578, 51063, 50593, 52161, 50271, 50157, 50480, 51401, 50603, 50620, 50634, 
                                  51243, 51531, 52595, 51562, 52624, 52644, 52701, 51656, 52728, 52033, 52749, 52757, 52773, 52168, 52206, 
                                  52210, 52219, 52232, 52249, 51242, 51244, 52315, 51350, 52337, 51364, 51441, 51444, 51520, 50107, 52557, 50612, 52657, 
                                  51467, 50078, 52778, 50598, 51238, 51020, 52346, 52591, 52767, 50473, 50559, 50840, 50430, 50029, 50142, 51036, 50242, 
                                  50444, 50227, 50255, 52308, 50316, 52229, 50069, 51631, 50119, 50319, 51461, 50597, 52209, 52359, 50011, 50141, 52737, 
                                  52531, 50543, 50573, 51554, 51578, 52647, 52566, 51647, 52030, 50028, 51101, 50124, 50671, 52765, 50847, 50272, 51009, 
                                  52307, 52501, 50032, 52220, 51050, 50478, 52534, 50545, 50571, 50591, 50127, 51549, 52750, 52134, 50660, 50041, 51363, 
                                  51459, 52537, 50643, 50470, 50531, 50154, 50848, 50070, 50239, 50066, 50118),
                       'value'=0)
p_zips_ia$region = as.character(p_zips_ia$region)


### Pete Michigan ###
p_zips_mi = data.frame('region'=c(48209, 49412, 48739, 49886, 49082, 48455, 49060, 49043, 48145, 49253, 48191, 49719, 48626, 48360, 49450, 48350, 48741, 
                                  49616, 48722, 49769, 48234, 49818, 48032, 48063, 48667, 48822, 48884, 49806, 48893, 48028, 49337, 48393, 48445, 48632, 
                                  48747, 49230, 48091, 49632, 48659, 49751, 48602, 48001, 48601, 48465, 49675, 49955, 48622, 48506, 49727, 49814, 48415, 
                                  49203, 48464, 49680, 49284, 48637, 49752, 49032, 49815, 48874, 49764, 48040, 49759, 49306, 49349, 49283, 49421, 48623, 
                                  49911, 49236, 48416, 48173, 49965, 49055, 49659, 49613, 49336, 49922, 49960, 48471, 49262, 48806, 48206, 48651, 49946, 
                                  48851, 48703, 49255, 48755, 49323, 48051, 48811, 48436, 49644, 48109, 49347, 48760, 48630, 49679, 49287, 49656, 49929, 
                                  48224, 48141, 49130, 48419, 49902, 49745, 48746, 49256, 49736, 49725, 54554, 49457, 48117, 48856, 48649, 49338, 48411, 
                                  48654, 49274, 49033, 49874, 49847, 49880, 48740, 48356, 48357, 49971, 48613, 48615, 48036, 48617, 48618,
                                  48417, 48432, 48421, 48383, 48426, 48435, 48437, 48438, 48441, 48444, 48140, 48472, 48473, 48475, 48476, 48502, 48174, 
                                  48456, 48179, 48458, 48165, 48166, 48463, 48467, 48529, 48504, 48211, 48609, 48216, 48219, 48233, 48184, 48015, 48177, 
                                  49722, 48213, 48235, 48238, 49454, 49455, 48754, 49098, 49837, 49838, 49445, 49446, 49119, 49092, 48743, 49451, 49094, 
                                  49716, 48748, 48815, 48817, 48756, 48819, 48757, 48759, 48761, 48762, 48763, 48765, 49726, 49459, 49728, 49729, 48808, 
                                  49461, 49233, 49238, 49235, 49240, 49241, 48829, 48832, 49252, 49224, 48841, 49229, 49237, 49747, 48845, 49272, 49276, 
                                  48860, 48861, 49277, 48846, 48847, 48853, 49254, 49544, 49264, 49268, 49748, 48880, 49768, 49620, 49310, 49623, 49628, 
                                  49774, 49775, 49318, 49777, 48871, 48873, 49322, 49303, 49327, 49788, 49791, 48033, 48885, 49795, 48891, 49330, 49805, 
                                  49331, 49629, 49812, 49779, 49325, 49635, 49825, 49649, 49826, 49827, 49638, 49831, 49834, 49645, 48469,
                                  49011, 49012, 48650, 48633, 49403, 49405, 48635, 48636, 49655, 49026, 48628, 49657, 49029, 49953, 49401, 49052, 49683, 
                                  49056, 48657, 49040, 49667, 48658, 49045, 49674, 48652, 48735, 48661, 49701, 49705, 48705, 49078, 48706, 48708, 48723, 
                                  48724, 48725, 49435, 49061, 49064, 49065, 48730, 49688, 49442, 49970, 49710, 48095, 48647, 48217, 48553, 48611, 49876, 
                                  49881, 49893, 49870, 49871, 49873, 49896, 49905, 49916, 49919, 49945, 49952, 49959, 49961, 48732, 49753, 48064, 49289, 
                                  48243, 48551, 48035, 48427, 48701, 49030, 49249, 49410, 48440, 49668, 48889, 49342, 49618, 49250, 48414, 48612, 49819, 
                                  48836, 48097, 49067, 54540, 49913, 48807, 49689, 49051, 49636, 49802, 49836, 49760, 49930, 49282, 48809, 49070, 49329, 
                                  49076, 49625, 49088, 48454, 48892, 49057, 49202, 49452, 48030, 48359, 48370, 48619, 49766, 49096, 48655, 49884, 48039, 
                                  48048, 48631, 49921, 49817, 49415, 48413, 48745, 48074, 49344, 48720, 49248, 48401, 49781, 49962, 49099,
                                  49232, 49776, 49963, 49458, 48897, 49050, 48728, 48468, 49969, 49927, 48850, 49332, 49251, 48614, 49713, 48342, 49425, 
                                  49013, 48023, 49820, 48883, 49619, 48638, 49872, 49715, 49242, 49676, 49744, 48192, 48877, 48881, 48742, 48604, 48446, 
                                  49853, 49724, 49743, 48818, 49220, 49735, 48835, 49305, 49271, 49279, 49891, 48888, 49420, 49612, 48120, 48875, 48429, 
                                  48096, 48412, 48420, 49816, 48159, 48466, 48470, 49017, 49028, 48461, 48634, 48190, 48418, 48449, 48894, 49312, 48043, 
                                  48215, 49066, 48519, 49073, 48731, 48204, 48164, 48327, 48766, 48770, 48721, 48878, 48139, 49266, 49270, 48865, 49286, 
                                  49326, 49245, 49614, 48890, 49340, 49642, 49822, 49833, 49048, 49653, 48218, 49799, 49034, 48060, 48727, 48738, 49072, 
                                  49840, 48223, 48228, 48229, 48457, 48503, 48133, 49829, 49666, 49839, 48726, 48505, 49877, 49267, 49796, 49259, 48886, 
                                  49934, 49901, 48240, 49947, 48242, 49643, 49717, 49104, 49968, 49848, 48767, 48813, 49227, 49733, 49246,
                                  49746, 48852, 49263, 49749, 49756, 48857, 49288, 48870, 49626, 49780, 49782, 49631, 49807, 48921, 49335, 49835, 48627, 
                                  49027, 49665, 48710, 49074, 49434, 48733, 48737, 49089, 49861, 49320, 48125, 49879, 49883, 49892, 49895, 49908, 49910, 
                                  49935, 49942, 49950, 49967, 49801, 49106, 49864, 48034, 48227, 48816, 49849, 49862, 48157, 49261, 48729, 48006, 49762, 
                                  49633, 48022, 49887, 48041, 48460, 48021, 48014, 49948, 48122, 49912, 48625, 48205, 48027, 48750, 49903, 48143, 48353, 
                                  48089, 48554, 48825, 49854, 48397, 49885, 49917, 49634, 49925, 48434, 49339, 49821, 49938, 48629, 49958, 48509, 48653, 
                                  48210, 49709, 49765, 48002, 49757, 49611, 49627, 48896, 49841, 49402, 49808, 48005, 48081, 49863, 48054, 48532, 49878, 
                                  49894, 49915, 48610, 48050, 48065, 49084, 49640, 49852, 48094, 49663),
                       'value'=0)
p_zips_mi$region = as.character(p_zips_mi$region)


### Pete Ohio ###
p_zips_oh = data.frame('region'=c(44865, 43044, 44254, 43711, 43728, 44614, 44889, 43431, 44032, 43071, 44830, 43009, 43931, 43469, 45345, 45771, 43119, 
                                  43001, 44906, 44511, 45674, 45859, 45381, 44707, 45732, 44127, 45734, 44818, 43735, 44634, 43824, 44506, 44676, 45851, 
                                  43788, 43723, 43545, 45153, 43154, 43135, 43963, 43754, 45669, 44625, 44878, 45767, 45353, 43549, 45115, 43432, 44613, 
                                  44443, 45652, 45773, 45775, 45135, 45838, 45330, 43005, 43332, 45618, 43925, 44306, 43605, 44708, 43713, 43930, 45338, 
                                  45303, 44874, 43822, 45167, 44004, 44627, 43905, 44515, 43773, 43013, 43010, 43762, 44671, 45685, 44887, 43951, 43317, 
                                  45619, 45867, 43318, 44481, 43608, 43556, 45317, 45614, 43359, 44451, 43940, 45672, 45130, 45418, 43319, 43517, 44401, 
                                  44653, 45334, 43060, 44606, 43433, 44214, 43123, 43731, 44620, 43447, 45123, 43213, 44125, 43326, 44221, 45697, 43932, 
                                  45727, 43443, 43983, 45820, 43450, 44505, 43008, 45306, 44274, 44028, 43030, 44307, 45871, 43344, 45787,
                                  45850, 43516, 44689, 44080, 45836, 45388, 43722, 43037, 45804, 45152, 43837, 45003, 43554, 44612, 43521, 44428, 45054, 
                                  45723, 45696, 43232, 45849, 44824, 43150, 44611, 44234, 43103, 44275, 43547, 43337, 45812, 45724, 45646, 45112, 45156, 
                                  45684, 45693, 43160, 43343, 43347, 43566, 43076, 43351, 43356, 43340, 43080, 45372, 45884, 45158, 43156, 43759, 43569, 
                                  43570, 43410, 43106, 43435, 43440, 43126, 43449, 43451, 43413, 43420, 43430, 43466, 43128, 43457, 43468, 43515, 43136, 
                                  43152, 43144, 43532, 43534, 44262, 43157, 43158, 43548, 43522, 43162, 43526, 43527, 43164, 43025, 43019, 43045, 43061, 
                                  45875, 45877, 45880, 45883, 43902, 45887, 45894, 44882, 43316, 43322, 43323, 43821, 43064, 43333, 45863, 43066, 45865, 
                                  45868, 43840, 45872, 45873, 45874, 43942, 44417, 43903, 44420, 43920, 44427, 43908, 44431, 43912, 43915, 43917, 44438, 
                                  44502, 44442, 44510, 44444, 43968, 44452, 44454, 43976, 45030, 44455, 45855, 43977, 43986, 43944, 44470,
                                  44473, 43946, 44485, 45002, 44491, 45065, 45067, 44041, 44045, 45107, 45118, 44608, 45052, 44609, 45147, 45148, 45159, 
                                  45162, 45168, 44629, 45171, 44624, 45176, 44628, 44638, 44048, 44643, 44644, 44067, 44651, 44084, 44085, 44086, 44101, 
                                  44099, 45225, 43609, 45320, 43787, 44682, 45337, 45245, 43614, 45302, 44667, 45308, 44117, 44695, 45630, 44677, 44680, 
                                  44201, 45346, 45350, 45352, 45359, 45362, 44704, 45368, 45370, 45160, 44706, 45070, 43717, 43617, 43719, 43720, 45341, 
                                  44721, 45505, 45613, 44804, 43747, 45380, 45384, 43739, 45390, 44230, 44710, 44814, 44817, 45404, 44718, 45417, 45678, 
                                  43783, 44822, 45680, 45681, 43758, 45682, 45686, 44827, 43766, 44276, 44280, 44836, 43772, 44260, 43755, 45644, 45650, 
                                  43778, 45659, 43779, 45671, 43780, 45778, 45782, 45788, 44304, 44867, 44844, 44305, 45833, 44847, 44310, 45813, 45821, 
                                  44851, 45828, 45830, 45831, 45832, 45711, 45715, 45721, 45735, 44837, 45741, 45743, 45744, 45760, 44841,
                                  45761, 44301, 45768, 45776, 45853, 45856, 45858, 45862, 43565, 43336, 45360, 43403, 45053, 45365, 44688, 43107, 44273, 
                                  43953, 45654, 44730, 45120, 43446, 45882, 43952, 43445, 44905, 44681, 43311, 44672, 43793, 43927, 43109, 45326, 43764, 
                                  43943, 45885, 43511, 43155, 43113, 44484, 44272, 45304, 45679, 45314, 43341, 43543, 45814, 45645, 45866, 45347, 45325, 
                                  44683, 45629, 44081, 44637, 43115, 45358, 43011, 43315, 45146, 45169, 45015, 44406, 43830, 44618, 44144, 44675, 45622, 
                                  44813, 44866, 45335, 45869, 43067, 43730, 43802, 45318, 44450, 45886, 45845, 43845, 45694, 45891, 44839, 45122, 44902, 
                                  45770, 43935, 43462, 44047, 44504, 45623, 44231, 45251, 45309, 45449, 45789, 43811, 44687, 45879, 44855, 44861, 44445, 
                                  43334, 43338, 43348, 45101, 45786, 43223, 44666, 44076, 43084, 45154, 44050, 44052, 44064, 44657, 43460, 43116, 43416, 
                                  43442, 44093, 44646, 44702, 45311, 44705, 45340, 45348, 44216, 45382, 43014, 43536, 43746, 43540, 44223,
                                  43006, 43145, 43148, 44843, 44846, 43760, 45740, 45634, 44826, 43465, 43767, 45426, 45628, 43748, 45764, 44859, 43029, 
                                  44864, 43211, 45860, 45898, 43843, 43901, 43062, 43314, 44662, 44412, 44436, 44890, 43928, 44003, 43945, 43964, 43988, 
                                  43342, 43102, 43407, 45383, 43360, 43072, 45844, 44854, 45647, 45328, 43464, 43910, 43149, 45784, 43734, 44302, 44092, 
                                  45864, 45881, 45890, 44402, 45312, 43736, 43310, 43357, 44413, 44408, 44441, 43947, 45695, 43804, 44423, 45333, 45064, 
                                  43732, 44056, 44656, 44699, 44115, 44840, 43358, 44621, 44010, 45439, 43727, 45692, 43771, 45846, 44632, 43077, 44403, 
                                  45729, 45653, 45432, 43105, 43406, 43408, 43111, 43117, 43434, 43439, 43463, 43501, 43505, 43140, 43142, 43002, 43153, 
                                  43525, 43531, 43535, 43541, 43553, 43555, 43557, 43032, 43055, 43070, 43331, 45876, 45889, 45896, 43832, 43842, 43844, 
                                  44405, 44880, 43907, 44437, 44439, 43926, 43939, 43948, 43961, 43962, 43967, 43973, 44493, 44503, 44509,
                                  45032, 45033, 45051, 45062, 44055, 45121, 45131, 45132, 45142, 44640, 44645, 45155, 45164, 44654, 44661, 45216, 44105, 
                                  44663, 44669, 45307, 45310, 44123, 45316, 45321, 45336, 44133, 45349, 45361, 45378, 43716, 43724, 44709, 44802, 45389, 
                                  43725, 43733, 43740, 44233, 44235, 44243, 44807, 44815, 44816, 45428, 45601, 45616, 45621, 45624, 44265, 45642, 45656, 
                                  45658, 45661, 45688, 43768, 43782, 43786, 44285, 44286, 45710, 45716, 45719, 45746, 45779, 43812, 44856, 45808, 45816, 
                                  45819, 45826, 45835, 45854, 45319, 45841, 45145, 44251, 44849, 44678, 43756, 43972, 43533, 45780, 45651, 43749, 44217, 
                                  43750, 44838, 45416, 45620, 45217, 45663, 43933, 44825, 45673, 44049, 43138, 43524, 45899, 45660, 44507, 45888, 45001, 
                                  45897, 45034, 45861, 43836, 44652, 45636, 43101, 43721, 44670, 44404, 45807, 44659, 43127, 44137, 44128, 44881, 44046, 
                                  44809, 44690, 43761, 44633, 45166, 45205, 43437, 43456, 45301, 43611, 44693, 45354, 43151, 43523, 43529,
                                  44828, 45657, 45698, 43033, 43036, 45745, 45363, 43914, 43321, 43913, 44440, 44449, 44215, 43974, 43458, 45218, 44490, 
                                  44607, 43467, 45339, 43985, 44850, 43519, 45612, 43210, 44610, 44411, 43504, 45769, 43934, 43240, 45041, 43970, 45870, 
                                  44697, 45332, 43217, 43805, 45351, 43738, 45617, 45640, 44853, 45809, 45772, 43971, 45172, 44104, 43330, 43777, 44626, 
                                  45111),
                       'value'=0)
p_zips_oh$region = as.character(p_zips_oh$region)



### Pete Pennsylvania ###
p_zips_pa = data.frame('region'=c(18923, 15120, 16720, 15561, 16937, 19344, 17212, 17026, 15901, 15433, 15633, 19152, 16683, 18452, 16602, 15052, 15085, 
                                  15357, 15845, 16668, 17047, 16851, 16914, 17868, 16733, 17221, 17049, 19116, 15337, 15345, 15030, 16403, 16341, 17271, 
                                  19021, 15428, 15417, 15022, 15711, 15644, 16362, 15951, 17229, 15458, 16881, 17847, 17812, 18106, 15551, 15360, 15734, 
                                  15429, 15047, 17360, 15827, 15612, 17555, 18080, 15690, 15225, 16636, 16645, 16563, 15049, 17304, 19534, 15444, 17970, 
                                  17023, 15853, 17967, 15832, 16034, 15961, 16405, 15923, 15926, 18014, 16150, 15327, 15411, 15530, 15545, 16040, 17933, 
                                  19602, 18660, 15677, 16045, 15454, 19442, 15142, 17048, 15954, 17748, 17222, 18079, 17934, 16504, 17005, 16151, 16255, 
                                  16333, 16334, 15363, 15432, 16053, 18342, 15450, 16933, 17082, 19536, 17509, 16360, 15461, 17547, 19310, 15639, 16840, 
                                  15413, 15330, 15521, 15625, 15348, 15075, 15638, 17822, 15442, 15436, 17721, 15611, 15759, 15747, 16622,
                                  15729, 17327, 17363, 18249, 16865, 17830, 16929, 15059, 15037, 15377, 16435, 17853, 15066, 15086, 16725, 16114, 16036, 
                                  17361, 15421, 16656, 15655, 18473, 18403, 18626, 17866, 15779, 15679, 15909, 16829, 19533, 17505, 16662, 18446, 15490, 
                                  18705, 15540, 16022, 15482, 15538, 15940, 17582, 15438, 17246, 15050, 16673, 15061, 16836, 17846, 17243, 16730, 15732, 
                                  15104, 15342, 16111, 15710, 17244, 15136, 15346, 18846, 15440, 15451, 16222, 17545, 16116, 16345, 16938, 15325, 16878, 
                                  17099, 17540, 15620, 15077, 16679, 15338, 16038, 15074, 16434, 15003, 18331, 18655, 18250, 15089, 15290, 15331, 17887, 
                                  17086, 15928, 16370, 16322, 15366, 15559, 17744, 15260, 15410, 18630, 15446, 15223, 17228, 16347, 15459, 17952, 17028, 
                                  16921, 15783, 17265, 15725, 17944, 18518, 16746, 16859, 16827, 15046, 17517, 16433, 16623, 16674, 15472, 16440, 18219, 
                                  15351, 17872, 17842, 19033, 16002, 18357, 16848, 17301, 15670, 16672, 15773, 15311, 15542, 15209, 15865,
                                  18844, 15427, 15081, 19017, 15437, 15558, 16145, 17314, 17224, 15637, 16117, 16659, 16027, 15379, 16374, 19345, 17065, 
                                  18407, 18801, 15905, 15226, 19511, 15477, 18011, 15135, 16839, 15145, 16671, 18824, 17021, 17087, 15322, 15640, 15137, 
                                  17727, 18917, 17052, 16639, 17103, 18954, 15860, 16820, 15430, 17581, 16738, 17835, 17217, 17834, 15470, 17060, 15776, 
                                  16130, 16922, 17845, 18847, 19492, 16734, 17093, 17081, 18212, 17823, 15761, 15347, 16948, 16936, 15848, 17345, 18837, 
                                  16874, 15627, 18439, 18230, 17067, 16057, 15333, 16946, 16037, 15239, 16258, 16510, 15934, 15028, 18354, 17535, 15746, 
                                  15051, 15480, 17829, 15632, 15672, 17022, 16035, 16235, 15004, 17974, 15054, 18220, 15866, 15721, 16680, 16436, 15771, 
                                  18330, 16321, 18709, 16218, 19512, 19518, 19538, 19529, 17267, 19541, 19543, 19551, 18413, 18831, 16665, 16666, 16667, 
                                  19555, 19560, 19567, 16682, 16685, 16689, 16693, 16724, 16726, 16822, 17923, 19437, 18503, 16745, 19506,
                                  17038, 16861, 16863, 16870, 16877, 16879, 16882, 16925, 16926, 16935, 16942, 16950, 17002, 17006, 17009, 17017, 17018, 
                                  16832, 16841, 17025, 17029, 17032, 16852, 16855, 17062, 17071, 17076, 15535, 17088, 16140, 17210, 17215, 15770, 17239, 
                                  17240, 17255, 17272, 16155, 17519, 17262, 17264, 17527, 17309, 17532, 17313, 17364, 17365, 17235, 17236, 17752, 17557, 
                                  17565, 17566, 17584, 17702, 17729, 17731, 17855, 17856, 17857, 17851, 17864, 17867, 17763, 17888, 17765, 17889, 17935, 
                                  17772, 17901, 17774, 17922, 17941, 17946, 17948, 17810, 17960, 17820, 17836, 17841, 15464, 15473, 15486, 18068, 17978, 
                                  17985, 18087, 18101, 18034, 18038, 18211, 18041, 17963, 18053, 18056, 17968, 18067, 15021, 15636, 15656, 15829, 15846, 
                                  15680, 15713, 15714, 18451, 15716, 15753, 15762, 15764, 15857, 15864, 15765, 18255, 18256, 15904, 15920, 18321, 15924, 
                                  15931, 15937, 15943, 15953, 18323, 18324, 18327, 15955, 15957, 15962, 18334, 18335, 16020, 16023, 18343,
                                  16025, 16028, 18350, 16050, 18353, 18355, 18441, 18443, 18370, 18372, 18405, 18237, 18240, 18248, 18419, 15550, 18421, 
                                  15552, 15554, 18426, 15618, 15622, 15772, 15775, 15821, 18616, 16051, 16052, 16054, 18708, 16059, 16063, 16314, 16124, 
                                  18818, 18821, 18828, 16134, 16136, 18833, 16229, 16244, 16143, 16159, 16161, 16256, 16260, 16262, 16224, 18617, 18618, 
                                  18453, 18454, 18457, 18622, 18624, 18460, 18465, 18466, 18632, 18469, 18470, 18636, 18507, 18653, 18656, 18603, 16421, 
                                  16423, 19365, 16371, 16438, 16404, 16442, 18842, 18845, 16616, 16619, 16620, 16621, 16627, 16637, 16641, 16646, 16647, 
                                  18964, 18972, 16655, 16661, 19055, 16329, 19014, 19020, 19032, 19111, 19113, 16344, 19124, 19138, 16346, 19149, 19330, 
                                  19352, 17507, 19564, 15455, 19012, 15662, 15748, 15925, 17550, 15053, 17742, 17270, 19544, 15754, 15484, 17850, 15691, 
                                  15730, 17080, 16112, 16444, 15361, 15689, 15948, 15133, 15483, 18046, 19549, 17247, 15006, 17606, 18245,
                                  15412, 18195, 17041, 16230, 17876, 17764, 17030, 17730, 15007, 15663, 15541, 18083, 15531, 15841, 15617, 15673, 16239, 
                                  15686, 15055, 15352, 16328, 15034, 18435, 15312, 18930, 16927, 15310, 15824, 16424, 16319, 15019, 18088, 17057, 17801, 
                                  16692, 18058, 16701, 16826, 16426, 18461, 16650, 19550, 16422, 15334, 17981, 16033, 17339, 16744, 15038, 16939, 18371, 
                                  17762, 15681, 16728, 15676, 17959, 18823, 15623, 16236, 15851, 17943, 17254, 18462, 16868, 16837, 16749, 17260, 15314, 
                                  15320, 16875, 16501, 17036, 15344, 15929, 15958, 15031, 17016, 18332, 15868, 17058, 17740, 17508, 17315, 18037, 16153, 
                                  15712, 15476, 15555, 17037, 15324, 15035, 15420, 18225, 15635, 15935, 15362, 15012, 18417, 16120, 18822, 16407, 16729, 
                                  16406, 16133, 15084, 19504, 16631, 17931, 15469, 15368, 15434, 18252, 16860, 18816, 16327, 16844, 15742, 18854, 16694, 
                                  17007, 18326, 15341, 16735, 16821, 15828, 16259, 19507, 16830, 19456, 16640, 19472, 19474, 19523, 19535,
                                  19545, 19562, 18517, 15467, 16249, 17219, 18472, 15678, 17880, 15468, 15949, 16217, 17562, 19140, 16102, 15684, 17953, 
                                  15207, 18464, 15010, 16838, 16657, 17747, 15823, 18623, 15956, 19136, 16928, 17520, 15349, 18224, 18241, 17324, 18615, 
                                  15849, 15520, 16624, 16917, 16833, 16041, 16835, 16847, 16361, 16853, 17576, 16613, 16876, 17813, 16920, 15460, 16911, 
                                  17004, 17407, 17035, 17213, 19009, 15695, 18834, 17724, 16611, 17964, 15018, 15364, 16232, 16871, 17840, 16313, 15834, 
                                  18642, 18214, 17370, 15741, 15722, 18346, 18244, 16441, 19056, 16317, 18829, 16834, 15380, 15757, 17512, 16411, 19505, 
                                  16240, 19142, 15020, 16125, 15376, 17056, 17249, 17072, 17075, 17077, 17097, 17214, 15009, 17220, 17068, 15723, 15744, 
                                  15431, 18086, 15738, 18254, 18602, 16263, 15456, 16732, 18832, 17044, 16748, 15536, 16416, 15448, 16115, 18074, 17238, 
                                  17250, 17253, 17256, 17263, 17306, 17311, 17318, 17343, 16351, 16625, 15063, 15610, 17053, 15942, 15547,
                                  15631, 15062, 15615, 18932, 16930, 17929, 15936, 15692, 15624, 17522, 16678, 16691, 16695, 16750, 19503, 16912, 17045, 
                                  16849, 16858, 17063, 17084, 17570, 17737, 17251, 17321, 17749, 17408, 17529, 17051, 16061, 17560, 17739, 17860, 17768, 
                                  17844, 17767, 17885, 17776, 17921, 17814, 17824, 16223, 15042, 15671, 17980, 15078, 18430, 18109, 18235, 15697, 18322, 
                                  18344, 18425, 16503, 16420, 15449, 15534, 18073, 17865, 18091, 18508, 18610, 17881, 18812, 17930, 17945, 17954, 15728, 
                                  16731, 19554, 16131, 18619, 18629, 18641, 18651, 15778, 15870, 15944, 16046, 18437, 18447, 18456, 17352, 16410, 18851, 
                                  19015, 19029, 16630, 16651, 16664, 19141, 19319, 19374, 16316, 16342, 15045, 17862, 17979, 18016, 18830, 18063, 17090, 
                                  18635, 18929, 15952, 15479, 16332, 15358, 16825, 15687, 15313, 15316, 15443, 15724, 15502, 15435, 18070, 18085, 16443, 
                                  18216, 18223, 18234, 18242, 15475, 17728, 17113, 16214, 15666, 16226, 15215, 15660, 15646, 15647, 15675,
                                  15733, 15745, 18333, 18351, 16312, 17066, 17223, 16845, 16210, 16743, 16828, 19526, 16932, 16947, 17777, 16123, 17563, 
                                  17237, 17252, 15847, 17268, 17329, 15863, 15922, 15927, 17024, 15960, 19131, 16352, 16030, 15861, 16401, 15332, 17536, 
                                  18455, 16699, 18459, 15043, 15856, 17983, 18519, 18614, 17046, 18621, 17878, 16923, 15628, 15736, 15938, 18445, 16157, 
                                  16141, 15148, 18628, 15024, 16872, 18810, 16417, 16110, 16311, 16132, 18251, 16727, 16740, 18631, 18657, 16350, 18661, 
                                  18980, 19023, 18817, 18825, 19109, 16635, 19137, 17778, 15462, 16248, 16943, 16634, 17884, 17094, 15533, 16048, 17760, 
                                  17372, 16233, 16238, 16245, 16340, 16343, 16353, 18843, 18848, 18850, 19022, 19036, 16427, 16601, 16633, 19114, 19126, 
                                  19405, 19435, 16121, 15737, 15750, 17355, 15767, 18424, 16029, 17266, 18231, 17344, 15777, 18936, 19133, 18105, 15072, 
                                  16253, 18427, 15629, 15756, 15447, 17861, 18352, 16843, 18032, 15510, 17317, 17039, 18915, 15321, 15419,
                                  15353, 17027, 17827, 17925, 15323, 15731, 15489, 15945, 19018, 16323, 15144, 18935, 15359, 15784, 15780, 16402, 19457, 
                                  15087, 15060, 16049, 19519, 18030, 19076, 19030, 15616, 15641, 19150, 15064, 15560, 17936, 18221, 15110, 17261, 18232, 
                                  15088, 18239, 17371, 16211, 17083, 16228, 15626, 17957, 16372, 16546, 18076, 17920, 19453, 17949, 17069, 16638, 15204, 
                                  15370, 15698, 15378, 15422, 18955, 15715, 16113, 15537, 15139, 15752, 16677, 15739, 16670, 19559, 17010, 15921, 16941, 
                                  17723, 17750, 17758, 17832, 15492, 15076, 19383, 15424, 18246, 18970, 15760, 15562, 19054, 15930, 18431, 18463, 16160, 
                                  15082, 17745, 15015, 15350, 18634, 16364, 16373, 19043, 16617, 19079, 17101, 15112, 15463, 17982, 15621, 15539, 18434, 
                                  15140, 15693, 19542, 15315, 19082, 17976, 15027, 15564, 15688, 16246, 17120, 17886, 18962, 15727, 15083, 15825, 15557, 
                                  15544, 17779, 16866, 17098, 19358, 15634, 17951, 18035, 15067, 18218, 15696, 18356, 15522, 15781, 16212,
                                  16250, 16024, 15661, 15466, 16652, 19367, 16331, 15474, 17211, 18625, 18814, 15033, 16213, 15717, 16854, 15014, 15946, 
                                  16940),
                       'value'=0)
p_zips_pa$region = as.character(p_zips_pa$region)


### Pete Wisconsin ###
p_zips_wi = data.frame('region'=c(53952, 54928, 54129, 54519, 53580, 53922, 54486, 53521, 53058, 54560, 53820, 54420, 54107, 54846, 54932, 54603, 53943, 
                                  54409, 53523, 54829, 54437, 54619, 54965, 54558, 54006, 53541, 54513, 53555, 54822, 54631, 53048, 54169, 53177, 54489, 
                                  54556, 53961, 53181, 53070, 54830, 53581, 54521, 53518, 54664, 54484, 53036, 54626, 53002, 54426, 54228, 53545, 54909, 
                                  53826, 54723, 53944, 53153, 54443, 54737, 53549, 54923, 53553, 54875, 53006, 54648, 53023, 54949, 54512, 53910, 54003, 
                                  54524, 53937, 54651, 53589, 54865, 53810, 54480, 54214, 54726, 53825, 54769, 54112, 54475, 54175, 54941, 53033, 54208, 
                                  54984, 53929, 54948, 54120, 53130, 54490, 53550, 53150, 53816, 54945, 54864, 54126, 54857, 53920, 53098, 54537, 53065, 
                                  54922, 54627, 54546, 53540, 54845, 54722, 53578, 54430, 53531, 54004, 53209, 53554, 54748, 53955, 54247, 54902, 53803, 
                                  53017, 53037, 53019, 53038, 53020, 53049, 53039, 53044, 53569, 53570, 53223, 53225, 53057, 53059, 53503,
                                  53507, 53510, 53078, 53091, 53522, 53093, 53525, 53061, 53530, 53088, 53086, 53544, 53556, 53126, 53559, 53114, 53115,
                                  53119, 53168, 53178, 53182, 53184, 53154, 53156, 54840, 54842, 53014, 54494, 53192, 53941, 53010, 53011, 53946, 54839, 
                                  54511, 54844, 53951, 54517, 53964, 54854, 54520, 53956, 54862, 53963, 54013, 54872, 54015, 54530, 54020, 54559, 54536, 
                                  54561, 54889, 54545, 54102, 54005, 54867, 54550, 54009, 54011, 54871, 54119, 54921, 54135, 54563, 54128, 54933, 54934, 
                                  54103, 54896, 54111, 54613, 54157, 54161, 54625, 54895, 54137, 54139, 54630, 54943, 54944, 54154, 54632, 54150, 54217, 
                                  54644, 54646, 54652, 54180, 54982, 54202, 54971, 54974, 54977, 54207, 54986, 54212, 54213, 54216, 54638, 53582, 53585, 
                                  54657, 54658, 54659, 54241, 54245, 54661, 54721, 53579, 54413, 54416, 54418, 54421, 54428, 54724, 54433, 54725, 54436, 
                                  54440, 54442, 54727, 54405, 54406, 54408, 54410, 54411, 54422, 54734, 54736, 54742, 53804, 54745, 54746,
                                  54747, 54741, 53809, 53811, 54732, 54452, 53827, 54767, 54470, 54471, 54768, 54456, 53911, 54465, 53821, 54828, 54810, 
                                  54813, 54488, 53924, 54491, 53930, 53932, 54773, 53933, 54805, 54824, 54666, 54010, 53939, 53801, 54758, 53021, 53560, 
                                  54962, 53936, 53034, 53969, 54082, 54234, 53586, 54159, 54964, 54459, 54462, 54407, 54412, 54130, 53923, 54763, 53576, 
                                  54211, 53295, 54858, 54861, 53079, 54230, 54110, 54853, 53807, 54770, 53085, 53035, 54623, 54423, 53206, 53195, 53501, 
                                  53571, 54515, 54653, 53561, 54826, 54635, 54220, 54138, 54968, 54229, 54835, 54766, 54026, 54940, 54479, 54023, 54485, 
                                  53960, 54566, 54424, 54870, 53137, 54611, 54539, 53167, 54979, 54495, 53926, 54960, 54435, 54850, 54303, 53179, 54499, 
                                  54124, 54498, 54812, 54733, 54621, 54425, 54772, 53536, 54827, 53526, 53587, 53042, 54628, 54930, 54963, 54966, 54125, 
                                  53566, 53108, 54614, 53046, 53215, 53063, 54205, 53598, 53577, 54427, 54446, 54731, 53517, 53805, 53806,
                                  53118, 54759, 54761, 54771, 54756, 54473, 53916, 54493, 54946, 53947, 53563, 54836, 54014, 53950, 54849, 54859, 54888, 
                                  54123, 54565, 54021, 54106, 53506, 53040, 54740, 53103, 54967, 53089, 54616, 53139, 54113, 54855, 54873, 54027, 54749, 
                                  54557, 54141, 54642, 54153, 54162, 54165, 54624, 54173, 54670, 53594, 54414, 54970, 54754, 53224, 54101, 53919, 54950, 
                                  54170, 53031, 53573, 53047, 53069, 53504, 54629, 53094, 53557, 53003, 53007, 53016, 53205, 53948, 54841, 54525, 54847, 
                                  54848, 54007, 54529, 54538, 54547, 54552, 54555, 54114, 54121, 54564, 54610, 54927, 54929, 54931, 54612, 54618, 54151, 
                                  54156, 54634, 54980, 54174, 54204, 54641, 54643, 54985, 54656, 53583, 54246, 54307, 54667, 53599, 53702, 54417, 54447, 
                                  53792, 53802, 53808, 54450, 54451, 54454, 53813, 53817, 54466, 54474, 53928, 53931, 54487, 54817, 54819, 53013, 54149, 
                                  54441, 53075, 54104, 54534, 54526, 54227, 54127, 54458, 53537, 53505, 54531, 54177, 54615, 54942, 54171,
                                  54232, 54755, 53170, 53004, 53216, 54645, 53935, 54514, 54856, 53172, 54541, 53218, 53901, 53953, 54160, 54166, 54765, 
                                  54527, 54876, 54880, 53125, 54622, 54637, 54639, 54654, 54136, 54760, 54469, 54820, 53502),
                       'value'=0)
p_zips_wi$region = as.character(p_zips_wi$region)



p_total_amount = df %>% 
  group_by(zip) %>% 
  summarize(total = sum(amount)) %>%
  rename(region=zip, value=total) %>% 
  bind_rows(p_zips_fl) %>% 
  bind_rows(p_zips_ia) %>%
  bind_rows(p_zips_mi) %>%
  bind_rows(p_zips_oh) %>%
  bind_rows(p_zips_pa) %>%
  bind_rows(p_zips_wi)


write.csv(p_total_amount, 'p_total_amount.csv')


p_total_donors = df %>% 
  group_by(zip) %>% 
  summarize(n_donors = n_distinct(donor)) %>%
  rename(region=zip, value=n_donors) %>% 
  bind_rows(p_zips_fl) %>% 
  bind_rows(p_zips_ia) %>% 
  bind_rows(p_zips_mi) %>% 
  bind_rows(p_zips_oh) %>% 
  bind_rows(p_zips_pa) %>% 
  bind_rows(p_zips_wi)

write.csv(p_total_donors, 'p_total_donors.csv')


p_avg_donor = df %>% 
  group_by(zip) %>% 
  summarize(avg_donor = sum(amount)/n_distinct(donor)) %>%
  rename(region=zip, value=avg_donor) %>% 
  bind_rows(p_zips_fl) %>% 
  bind_rows(p_zips_ia) %>% 
  bind_rows(p_zips_mi) %>% 
  bind_rows(p_zips_oh) %>% 
  bind_rows(p_zips_pa) %>% 
  bind_rows(p_zips_wi)

write.csv(p_avg_donor, 'p_avg_donor.csv')

zip_choropleth(p_total_donors,
               state_zoom = "ohio",
               num_colors = 9,
               title      = "Pete Buttigieg: TBD",
               legend     = "Total Amount ($)")














